# kmeans_gpu

Compile:
```
$ make
```

Usage:
```
$ ./bin/kmeans
Usage:
        --num_cluster or -k <num_cluster>
        --dims or -d <dims>
        --inputfilename or -i <inputfilename>
        --max_num_iter or -m <max_num_iter>
        --threshold or -t <threshold>
        --seed or -s <seed>
        --implement_type or -x <implement_type> (cpu / cuda / thrust)
        [Optional] --centroids or -c
        [Optional] --unchanged_converge or -u
```

Example:
- cpu

```
$ ./bin/kmeans -k 16 -d 32 -i sample/random-n65536-d32-c16.txt -m 150 -t 0.000000001 -s 8675309 -c -u -x cpu
iter: 117, unchanged: true
117,0.030084
0 0.749189 0.701387 0.655344 0.712316 0.902698 0.640077 0.372451 0.537955 0.207827 0.587159 0.008862 0.151021 0.333489 0.789660 0.718509 0.338287 0.620568 0.041199 0.163860 0.981916 0.289540 0.394726 0.548455 0.293386 0.478081 0.239665 0.048301 0.179603 0.523109 0.070782 0.403186 0.328493
1 0.670011 0.201986 0.609748 0.218830 0.340217 0.962545 0.899033 0.818164 0.035473 0.148405 0.256833 0.784142 0.842275 0.583018 0.718102 0.807030 0.066400 0.084690 0.868837 0.039435 0.225108 0.040613 0.015349 0.843905 0.330559 0.160647 0.148800 0.656064 0.968643 0.504996 0.901076 0.502397
2 0.793323 0.082372 0.612791 0.486445 0.630145 0.845074 0.243038 0.731490 0.117136 0.220459 0.794583 0.332540 0.815923 0.100608 0.146361 0.697673 0.045233 0.573862 0.910014 0.534200 0.680592 0.026698 0.635003 0.606340 0.575950 0.391202 0.370143 0.980511 0.036395 0.021643 0.961026 0.184974
3 0.471630 0.409907 0.569114 0.508606 0.311443 0.357152 0.837672 0.250940 0.560609 0.012436 0.741582 0.335917 0.045696 0.280889 0.240132 0.953126 0.352223 0.287881 0.359194 0.946910 0.633741 0.621079 0.715623 0.388015 0.414418 0.650835 0.001527 0.192303 0.334405 0.239417 0.637399 0.378644
4 0.717320 0.002355 0.822731 0.528353 0.097786 0.118902 0.649269 0.873655 0.279986 0.978511 0.100185 0.853941 0.396696 0.081347 0.274716 0.452975 0.792340 0.861352 0.133413 0.520864 0.650776 0.347057 0.871868 0.278408 0.018576 0.040667 0.680992 0.558355 0.946502 0.938435 0.909856 0.042010
5 0.749086 0.701262 0.655386 0.712395 0.902714 0.640190 0.372448 0.537902 0.207856 0.587084 0.008927 0.151038 0.333334 0.789587 0.718488 0.338225 0.620501 0.041215 0.163860 0.981915 0.289518 0.394851 0.548505 0.293435 0.478062 0.239746 0.048210 0.179582 0.522999 0.070943 0.403152 0.328540
6 0.542991 0.419407 0.235274 0.387938 0.276008 0.863456 0.709537 0.789258 0.302778 0.830487 0.263773 0.503944 0.296187 0.044547 0.711472 0.183912 0.089900 0.405887 0.502922 0.327735 0.348535 0.670431 0.685777 0.459720 0.447748 0.779738 0.745031 0.481420 0.775904 0.330097 0.312987 0.589797
7 0.670119 0.201980 0.609797 0.218724 0.340235 0.962582 0.898985 0.818070 0.035461 0.148332 0.256925 0.784198 0.842390 0.582885 0.718175 0.807093 0.066317 0.084604 0.868963 0.039407 0.225072 0.040655 0.015230 0.844010 0.330611 0.160735 0.148850 0.656116 0.968550 0.505008 0.901087 0.502446
8 0.414722 0.099406 0.908669 0.474037 0.840812 0.976233 0.343651 0.479124 0.699571 0.426541 0.301841 0.734768 0.894401 0.919666 0.626678 0.375566 0.974486 0.638876 0.065834 0.084646 0.749843 0.061137 0.007816 0.393856 0.518963 0.448594 0.488644 0.584917 0.679317 0.423045 0.368382 0.988555
9 0.414726 0.099389 0.908644 0.473979 0.840888 0.976227 0.343661 0.479053 0.699621 0.426533 0.301966 0.734715 0.894396 0.919712 0.626822 0.375590 0.974629 0.638882 0.065836 0.084692 0.749891 0.061173 0.007873 0.393751 0.519058 0.448492 0.488599 0.584854 0.679293 0.423035 0.368277 0.988359
10 0.305313 0.113446 0.425971 0.566010 0.922882 0.935757 0.415642 0.099203 0.773816 0.734280 0.030700 0.446717 0.686417 0.030140 0.919295 0.962241 0.722542 0.078536 0.070327 0.359254 0.029384 0.347876 0.009971 0.974323 0.819008 0.070517 0.893437 0.207977 0.204791 0.673757 0.938261 0.123188
11 0.123860 0.210651 0.800735 0.937003 0.022783 0.425618 0.101464 0.259886 0.220860 0.646910 0.350329 0.180343 0.503558 0.039347 0.100914 0.988226 0.199269 0.358563 0.731667 0.838342 0.918464 0.169421 0.672616 0.966575 0.058049 0.676233 0.845416 0.342377 0.250702 0.596866 0.442330 0.174830
12 0.724543 0.623400 0.609901 0.580194 0.846290 0.582718 0.784079 0.126504 0.490417 0.429051 0.491944 0.504880 0.639271 0.474920 0.670874 0.867585 0.646433 0.484650 0.233390 0.495273 0.690800 0.533225 0.126767 0.929603 0.788131 0.193221 0.566696 0.898362 0.231911 0.659738 0.221678 0.250330
13 0.123921 0.210505 0.800747 0.936933 0.022792 0.425606 0.101548 0.259961 0.220806 0.646949 0.350256 0.180293 0.503709 0.039414 0.100945 0.988241 0.199440 0.358546 0.731543 0.838310 0.918509 0.169433 0.672651 0.966530 0.058067 0.676172 0.845423 0.342255 0.250684 0.596715 0.442295 0.174805
14 0.731291 0.773527 0.271274 0.591053 0.657826 0.665383 0.828939 0.495459 0.646338 0.550629 0.845728 0.344146 0.536349 0.597476 0.688702 0.354776 0.848603 0.521129 0.420740 0.918508 0.399696 0.816949 0.922215 0.675094 0.522845 0.159351 0.260845 0.716962 0.900680 0.871367 0.589692 0.638822
15 0.424195 0.624858 0.572510 0.199630 0.647621 0.344531 0.506850 0.427239 0.307216 0.575182 0.671901 0.166804 0.541587 0.873624 0.557531 0.705103 0.568669 0.945291 0.671782 0.419610 0.393129 0.297827 0.659911 0.891121 0.502379 0.570552 0.828266 0.563582 0.632362 0.600316 0.980061 0.760192
```

- cuda

```
$ ./bin/kmeans -k 16 -d 32 -i sample/random-n65536-d32-c16.txt -m 150 -t 0.000000001 -s 8675309 -c -u -x cuda
117,0.002027
0 0.749189 0.701387 0.655344 0.712316 0.902698 0.640077 0.372451 0.537955 0.207827 0.587159 0.008862 0.151021 0.333489 0.789660 0.718509 0.338287 0.620568 0.041199 0.163860 0.981916 0.289540 0.394726 0.548455 0.293386 0.478081 0.239665 0.048301 0.179603 0.523109 0.070782 0.403186 0.328493
1 0.670011 0.201986 0.609748 0.218830 0.340217 0.962545 0.899033 0.818164 0.035473 0.148405 0.256833 0.784142 0.842275 0.583018 0.718102 0.807030 0.066400 0.084690 0.868837 0.039435 0.225108 0.040613 0.015349 0.843905 0.330559 0.160647 0.148800 0.656064 0.968643 0.504996 0.901076 0.502397
2 0.793323 0.082372 0.612791 0.486445 0.630145 0.845074 0.243038 0.731490 0.117136 0.220459 0.794583 0.332540 0.815923 0.100608 0.146361 0.697673 0.045233 0.573862 0.910014 0.534200 0.680592 0.026698 0.635003 0.606340 0.575950 0.391202 0.370143 0.980511 0.036395 0.021643 0.961026 0.184974
3 0.471630 0.409907 0.569114 0.508606 0.311443 0.357152 0.837672 0.250940 0.560609 0.012436 0.741582 0.335917 0.045696 0.280889 0.240132 0.953126 0.352223 0.287881 0.359194 0.946910 0.633741 0.621079 0.715623 0.388015 0.414418 0.650835 0.001527 0.192303 0.334405 0.239417 0.637399 0.378644
4 0.717320 0.002355 0.822731 0.528353 0.097786 0.118902 0.649269 0.873655 0.279986 0.978511 0.100185 0.853941 0.396696 0.081347 0.274716 0.452975 0.792340 0.861352 0.133413 0.520864 0.650776 0.347057 0.871868 0.278408 0.018576 0.040667 0.680992 0.558355 0.946502 0.938435 0.909856 0.042010
5 0.749086 0.701262 0.655386 0.712395 0.902714 0.640190 0.372448 0.537902 0.207856 0.587084 0.008927 0.151038 0.333334 0.789587 0.718488 0.338225 0.620501 0.041215 0.163860 0.981915 0.289518 0.394851 0.548505 0.293435 0.478062 0.239746 0.048210 0.179582 0.522999 0.070943 0.403152 0.328540
6 0.542991 0.419407 0.235274 0.387938 0.276008 0.863456 0.709537 0.789258 0.302778 0.830487 0.263773 0.503944 0.296187 0.044547 0.711472 0.183912 0.089900 0.405887 0.502922 0.327735 0.348535 0.670431 0.685777 0.459720 0.447748 0.779738 0.745031 0.481420 0.775904 0.330097 0.312987 0.589797
7 0.670119 0.201980 0.609797 0.218724 0.340235 0.962582 0.898985 0.818070 0.035461 0.148332 0.256925 0.784198 0.842390 0.582885 0.718175 0.807093 0.066317 0.084604 0.868963 0.039407 0.225072 0.040655 0.015230 0.844010 0.330611 0.160735 0.148850 0.656116 0.968550 0.505008 0.901087 0.502446
8 0.414722 0.099406 0.908669 0.474037 0.840812 0.976233 0.343651 0.479124 0.699571 0.426541 0.301841 0.734768 0.894401 0.919666 0.626678 0.375566 0.974486 0.638876 0.065834 0.084646 0.749843 0.061137 0.007816 0.393856 0.518963 0.448594 0.488644 0.584917 0.679317 0.423045 0.368382 0.988555
9 0.414726 0.099389 0.908644 0.473979 0.840888 0.976227 0.343661 0.479053 0.699621 0.426533 0.301966 0.734715 0.894396 0.919712 0.626822 0.375590 0.974629 0.638882 0.065836 0.084692 0.749891 0.061173 0.007873 0.393751 0.519058 0.448492 0.488599 0.584854 0.679293 0.423035 0.368277 0.988359
10 0.305313 0.113446 0.425971 0.566010 0.922882 0.935757 0.415642 0.099203 0.773816 0.734280 0.030700 0.446717 0.686417 0.030140 0.919295 0.962241 0.722542 0.078536 0.070327 0.359254 0.029384 0.347876 0.009971 0.974323 0.819008 0.070517 0.893437 0.207977 0.204791 0.673757 0.938261 0.123188
11 0.123860 0.210651 0.800735 0.937003 0.022783 0.425618 0.101464 0.259886 0.220860 0.646910 0.350329 0.180343 0.503558 0.039347 0.100914 0.988226 0.199269 0.358563 0.731667 0.838342 0.918464 0.169421 0.672616 0.966575 0.058049 0.676233 0.845416 0.342377 0.250702 0.596866 0.442330 0.174830
12 0.724543 0.623400 0.609901 0.580194 0.846290 0.582718 0.784079 0.126504 0.490417 0.429051 0.491944 0.504880 0.639271 0.474920 0.670874 0.867585 0.646433 0.484650 0.233390 0.495273 0.690800 0.533225 0.126767 0.929603 0.788131 0.193221 0.566696 0.898362 0.231911 0.659738 0.221678 0.250330
13 0.123921 0.210505 0.800747 0.936933 0.022792 0.425606 0.101548 0.259961 0.220806 0.646949 0.350256 0.180293 0.503709 0.039414 0.100945 0.988241 0.199440 0.358546 0.731543 0.838310 0.918509 0.169433 0.672651 0.966530 0.058067 0.676172 0.845423 0.342255 0.250684 0.596715 0.442295 0.174805
14 0.731291 0.773527 0.271274 0.591053 0.657826 0.665383 0.828939 0.495459 0.646338 0.550629 0.845728 0.344146 0.536349 0.597476 0.688702 0.354776 0.848603 0.521129 0.420740 0.918508 0.399696 0.816949 0.922215 0.675094 0.522845 0.159351 0.260845 0.716962 0.900680 0.871367 0.589692 0.638822
15 0.424195 0.624858 0.572510 0.199630 0.647621 0.344531 0.506850 0.427239 0.307216 0.575182 0.671901 0.166804 0.541587 0.873624 0.557531 0.705103 0.568669 0.945291 0.671782 0.419610 0.393129 0.297827 0.659911 0.891121 0.502379 0.570552 0.828266 0.563582 0.632362 0.600316 0.980061 0.760192
```
